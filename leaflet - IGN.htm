<html>
<head>
  <meta charset=utf-8 />
  <title>Esri Leaflet Quickstart</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- Load Leaflet from CDN -->
    <link rel="stylesheet" href="./leaflet.css" crossorigin=""/>
    <script src="./leaflet-src.js" crossorigin=""></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="./esri-dist/esri-leaflet-debug.js" crossorigin=""></script>

    <!-- Extension Géoportail pour Leaflet -->
    <link rel="stylesheet" href="./ign-distGpPluginLeaflet.css" />
    <script src="./ign-dist/GpPluginItowns.js" data-key="b5hd53pk9bbp1447qzygfcpa"></script>

  <style>
    body { margin:0; padding:0; }
    #map { position: absolute; top:0; bottom:0; right:0; left:0; }
  </style>
</head>
<body>

<div id="map"></div>

<script>
  //var map = L.map("map").setView([43.58, 7.0], 12);
  var map = L.map("map").setView([48.84, 2.34], 12);

  //L.esri.basemapLayer("Topographic").addTo(map);
 
  // Appel de la Projection Lambert 93
  //var LAMB93 = new L.Proj.CRS('IGNF:LAMB93'); 
  
  L.tileLayer(
        "https://wxs.ign.fr/CLEF/geoportail/wmts?" +
        "&REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0" +
        "&STYLE=normal" +
        "&TILEMATRIXSET=PM" +
        "&FORMAT=image/jpeg"+
        "&LAYER=ORTHOIMAGERY.ORTHOPHOTOS"+
	"&TILEMATRIX={z}" +
        "&TILEROW={y}" +
        "&TILECOL={x}",
	{
		minZoom : 0,
		maxZoom : 18,
                attribution : "IGN-F/Geoportail",
		tileSize : 256 // les tuiles du Géooportail font 256x256px
	}
  ).addTo(map) ;

  /*
  
  var bbox = [643250.0, 6857750.0, 654500.0, 6863750.0];
  
  var maxResolution=2048.0;
  
  var scale = function (zoom) {
    return 1/(maxResolution /Math/pow(2,zoom)):
  };
  
  var transformation = new L.Transform(1,-bbox[0], -1,bbox[3]);
  
    
  // Official Spatial Reference from http://www.spatialreference.org/ref/epsg/2154/
  var L93 = L.CRS.proj4js('EPSG:2154',
			  '+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
			  transformation);
  crs.scale = scale; // required by Leaflet 0.4
  
  // Location of tiles (see next paragraph)
  var ignLayer = new L.TileLayer('http://localhost:8080/1.0.0/ign/{z}/{x}/{y}.png', {
      continuousWorld: true,  // very important
  });
    
  map = new L.Map('map', {
    crs: L93,
    scale: scale,
    continuousWorld: true,  // very important
    layers: [ignLayer,]
    // Initial view
    center: new L.LatLng(48.84, 2.34), // Universal Lat/Lng
    zoom: 5,
});
*/
  
  
</script>

</body>
</html>